# コマンドリファレンス

最終更新: 2025-12-12

## 概要

Tennis Discovery AgentのDiscord操作リファレンスです。

---

## 📋 目次

- [チャンネル操作](#チャンネル操作)
- [ボタン操作](#ボタン操作)
- [入力フォーマット](#入力フォーマット)
- [DM操作](#dm操作)

---

## チャンネル操作

Tennis Discovery Agentは、コマンドではなくチャンネルを選択してメッセージを送信する方式です。

### メイン記録チャンネル

| チャンネル | 英語エイリアス | 絵文字 | 用途 |
|-----------|---------------|--------|------|
| `#壁打ち` | `wall`, `wall-practice` | 🧱 | 基礎練習・反復ドリルの記録 |
| `#スクール` | `school`, `lesson` | 🎓 | コーチ指導がある練習の記録 |
| `#試合` | `match`, `game` | 🏆 | 実戦・練習試合の記録 |
| `#フリー練習` | `free`, `free-practice` | 🎾 | 友人との自由練習の記録 |

**操作:**
- 音声メッセージを送信 → 文字起こし＆構造化記録
- テキストメッセージを送信（10文字以上）→ 構造化記録
- 画像を添付 → 画像メモとして記録
- 動画を添付 → 動画メモとして記録

---

### 特殊チャンネル

| チャンネル | 英語エイリアス | 絵文字 | 用途 |
|-----------|---------------|--------|------|
| `#振り返り` | `reflection`, `review` | 📝 | 過去メモへの追記・補足 |
| `#質問` | `question`, `qa` | ❓ | 過去の記録を検索して質問に回答 |
| `#分析` | `analysis`, `analytics` | 📊 | 期間指定のAI分析レポート |

---

### 振り返りチャンネルの使い方

**目的:** 過去のメモに追記・補足を追加する

**メッセージ形式:**
```
[日付] [キーワード] [追記内容]
```

**例:**
```
11月27日の壁打ちのメモに追記
あの時やった「左手の脱力」は今でも効果的だと感じました。
```

**対応する日付表現:**

| 表現タイプ | 例 |
|-----------|---|
| 完全日付 | `2025/11/27`, `2025-11-27`, `2025年11月27日` |
| 短縮日付 | `11/27`, `11月27日`（当年を仮定） |
| 相対日付 | `昨日`, `一昨日`, `3日前`, `先週の水曜日` |

---

### 質問チャンネルの使い方

**目的:** 過去の記録から質問に回答してもらう

**メッセージ形式:**
```
[質問内容]
```

**例:**
```
サーブのトスで気をつけたことは？
```

```
最近うまくいった練習は何？
```

```
バックハンドの調子が悪い時はどうすればいい？
```

---

### 分析チャンネルの使い方

**目的:** 期間を指定してAI分析レポートを生成

**メッセージ形式:**
```
[期間表現] を分析して
```

**対応する期間表現:**

| 表現 | 対象期間 |
|-----|---------|
| `今週`, `this week` | 7日間 |
| `今月`, `this month` | 30日間（デフォルト） |
| `3ヶ月`, `three months` | 90日間 |
| `半年`, `six months` | 180日間 |
| `1年`, `year` | 365日間 |

**例:**
```
今月の練習を分析して
```

```
3ヶ月の成長を振り返りたい
```

---

## ボタン操作

### アクションボタン

音声メモを送信すると、ボットが3つのボタンを表示します。

| ボタン | 絵文字 | 機能 |
|--------|-------|------|
| **深堀り質問** | 🤔 | AIが追加の深掘り質問を生成 |
| **過去と比較** | 📊 | 類似の過去メモと比較分析 |
| **そのまま終了** | ✅ | 現在の内容で記録を確定 |

**タイムアウト:** 60秒

> **Note:** 60秒経過するとボタンは無効化され、自動的に保存されます。

---

### 確認ダイアログ

一部の操作で確認ダイアログが表示されることがあります。

| ボタン | 絵文字 | 機能 |
|--------|-------|------|
| **はい** | ✅ | 確認・実行 |
| **いいえ** | ❌ | キャンセル |

**タイムアウト:** 30秒

> **Note:** 30秒経過すると「いいえ」と同じ扱いになります。

---

### ボタン操作の流れ

**深掘り質問の例:**

1. 音声メモを送信
2. ボットが応答を返し、ボタンを表示
3. 🤔「深堀り質問」をクリック
4. ボットが深掘り質問を生成
   ```
   その時、身体のどこを意識していましたか？
   ```
5. 質問に回答して、さらに詳しく記録
6. ✅「そのまま終了」で確定

**過去と比較の例:**

1. 音声メモを送信
2. 📊「過去と比較」をクリック
3. ボットが類似メモを検索し、比較分析を表示
   ```
   【前回（11/25）との比較】
   - 共通点: トスの安定性を意識
   - 進歩: 脱力感覚が向上
   - 次の課題: 2ndサーブの安定性
   ```
4. ✅「そのまま終了」で確定

---

## 入力フォーマット

### 音声メモ

| 項目 | 制限 |
|------|------|
| 対応形式 | `.ogg`, `.mp3`, `.wav`, `.m4a`, `.opus`, `.webm` |
| 最大サイズ | 20MB |
| 推奨長さ | 1-2分以内 |

**Tips:**
- Discord標準の音声録音機能を使用するのが最も簡単
- 長い音声は分割して送信

---

### テキストメモ

| 項目 | 制限 |
|------|------|
| 最低文字数 | 10文字以上 |
| 除外対象 | `!`で始まるメッセージ（コマンド扱い） |

---

### 画像

| 項目 | 制限 |
|------|------|
| 対応形式 | `.jpg`, `.jpeg`, `.png`, `.gif` |
| 最大サイズ | 20MB |

**添付方法:**
1. 画像ファイルを添付
2. コメントを追加（任意）
3. 送信

---

### 動画

| 項目 | 制限 |
|------|------|
| 対応形式 | `.mp4`, `.mov`, `.avi`, `.webm` |
| 最大サイズ | 20MB |

**Tips:**
- Discordの20MB制限があるため、長時間の動画は圧縮が必要
- 解像度を下げるか、長さを短縮して対応

---

## DM操作

### Bot停止時のバックアップ

Bot停止中でもDMにメッセージを送信しておくことで、Bot復旧後に処理されます。

**手順:**
1. Botの名前をクリックしてDMを開く
2. 音声/テキスト/画像/動画を送信
3. メッセージ本文に「壁打ち」「スクール」などのシーン名を記載
4. Bot復旧後、自動的に処理される
5. 処理済みメッセージに✅がつく

**例:**
```
壁打ち

今日は30分サーブの練習をしました。
```

**注意:**
- `ADMIN_USER_ID`環境変数の設定が必要
- シーン名を記載しないとデフォルトで「フリー練習」として処理

---

## 返信操作

### メモへの追加情報

過去のメモに返信することで、追加情報を記録できます。

**手順:**
1. ボットの応答メッセージを長押し（または右クリック）
2. 「返信」を選択
3. 追加情報を入力して送信

**用途:**
- 後から思い出した気づきを追記
- 画像・動画を追加
- 深掘り質問に回答

---

## 関連ドキュメント

- **基本的な使い方:** [`../基本的な使い方.md`](../基本的な使い方.md)
- **機能一覧:** [`../機能一覧.md`](../機能一覧.md)
- **環境変数:** [`環境変数.md`](./環境変数.md)
- **トラブルシューティング:** [`トラブルシューティング.md`](./トラブルシューティング.md)
